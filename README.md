# Обнаружение глазных белков

Этот Python-скрипт использует библиотеку OpenCV для обнаружения лиц, глаз и белков глаз на изображении с применением каскадов Хаара. Скрипт обрабатывает входное изображение, выделяет лицевые особенности и сохраняет результат в виде изображения с аннотациями.

## Возможности
- **Обнаружение лиц**: Находит лица на изображении с использованием каскада Хаара.
- **Обнаружение глаз**: Определяет глаза в области найденных лиц.
- **Обнаружение белков глаз**: Выделяет белки глаз с помощью пороговой обработки и обнаружения контуров.
- **Визуализация**: Рисует рамки вокруг лиц (синие), глаз (зелёные) и белков глаз (жёлтые), а также отображает количество найденных белков на изображении.
- **Сохранение результата**: Сохраняет обработанное изображение как `output.jpg`.

## Требования
- Python 3.x
- OpenCV (`opencv-python`)
- NumPy

Установите зависимости с помощью pip:
```bash
pip install opencv-python numpy
```
или
```bash
pip install -r requirements.txt
```

## Использование
1. Поместите файл изображения (например, `image.jpg`) в ту же директорию, где находится скрипт.
2. Запустите скрипт:
   ```bash
   python script.py
   ```
3. Скрипт выполнит следующее:
   - Загрузит изображение.
   - Обнаружит лица, глаза и белки глаз.
   - Отобразит обработанное изображение с аннотациями.
   - Сохранит результат как `output.jpg`.
4. Нажмите любую клавишу, чтобы закрыть окно с изображением.

## Функции
- `load_image(path)`: Загружает изображение по указанному пути в формате BGR.
- `detect_faces(image, scale_factor, min_neighbors)`: Обнаруживает лица на изображении с помощью каскадов Хаара.
- `detect_eyes(image, scale_factor, min_neighbors)`: Обнаруживает глаза в области лица.
- `detect_eye_whites(image, eyes, step)`: Выделяет и подсвечивает белки глаз с использованием пороговой обработки и контуров.
- `main(image_path)`: Координирует процесс обнаружения и визуализирует результаты.

## Параметры
- **scale_factor**: Коэффициент масштабирования для обнаружения каскадами Хаара (по умолчанию: 1.3 для лиц, 1.3 для глаз).
- **min_neighbors**: Минимальное количество соседей для подтверждения обнаружения (по умолчанию: 5 для лиц, 6 для глаз).
- **step**: Шаг увеличения порога яркости для обнаружения белков глаз (по умолчанию: 10).

## Примечания
- Скрипт использует предобученные каскады Хаара (`haarcascade_frontalface_default.xml` и `haarcascade_eye.xml`), входящие в состав OpenCV.
- Для оптимального результата используйте чёткое изображение с хорошим освещением.
- Скрипт предполагает, что входное изображение находится в той же директории. При необходимости измените параметр `image_path` в функции `main()`.
- Если лица не обнаружены, скрипт выведет сообщение и завершит работу.

## Пример вывода
- Вход: `image.jpg`
- Выход: `output.jpg` с аннотированными лицами, глазами и белками глаз.
- Вывод в консоль:
  ```
  Найдено лиц: 1
  Найдено глаз: 2
  Найдено белков: 2
  ```

## Ограничения
- Точность обнаружения зависит от качества изображения и условий освещения.
- Метод каскадов Хаара может давать ложные срабатывания или пропускать объекты в сложных сценах.
- Обнаружение белков глаз чувствительно к параметру `step` и может потребовать настройки для разных изображений.
